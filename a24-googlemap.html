<!doctype html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<script src="jquery-3.3.1.min.js"></script>
	<script async src="https://maps.googleapis.com/maps/api/js?callback=machKarte"></script>
	<script>
var meineMap;
var machKarte = function() {
	var kartenoptionen = {
		center:{ lat:48.1, lng:16.45 },
		zoom:8
	}
	meineMap = new google.maps.Map( $('#karte').get(0), kartenoptionen );

    //loadPreviousMarkers();
}
var alleOrte = [];
var machMarker = function( position ) {
	return new google.maps.Marker({
		position:position,
		map:meineMap
	})
}

var loadPreviousMarkers = function (){
    var jsontemp = localStorage.getItem('orte');
    if(!jsontemp){

        return;
    }
    //alleOrte =jsontemp.all;
    var obj =JSON.parse(jsontemp);
    var a = obj.all;
    a.forEach(function(item,index){
        var tempPosObj ={
            lat:item.pos.lat,
            lng:item.pos.lng
        }
         machMarker(tempPosObj);
    });
}
$( document ).on('click','#save', function() {
	var markerName = $('#mname').val();
	var position = meineMap.getCenter();
    var neuerOrt ={
        name: markerName,
        pos: {lat:position.lat(),lng:position.lng()}
        //marker: machMarker(position)
    };
    machMarker(position);
    alleOrte.push(neuerOrt);

    var alleOrteObjekt = {
        all: alleOrte
    }


    var alleOrteString = JSON.stringify(alleOrteObjekt);
    localStorage.setItem("orte",alleOrteString);
    //console.log(localStorage.getItem("orte"));
    //localStorage.clear();//alles entfernen



});


	</script>
	<style>
#karte { border:1px solid #000; width:400px; height:300px; }
	</style>
</head>
<body>
<div id="karte"></div>
<input type="text" id="mname" placeholder="wie heisst der Ort?">
<button id="save">Speichern</button>
</body>
</html>
